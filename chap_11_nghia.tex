% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same} % disable monospaced font for URLs
\hypersetup{
  pdftitle={chapter11},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}

\title{chapter11}
\author{}
\date{\vspace{-2.5em}2022-05-21}

\begin{document}
\maketitle

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(GLMsData)}
\FunctionTok{data}\NormalTok{(}\StringTok{"nambeware"}\NormalTok{); }\FunctionTok{str}\NormalTok{(nambeware)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 'data.frame':    59 obs. of  4 variables:
##  $ Type : Factor w/ 5 levels "Bowl","CassDish",..: 2 2 2 1 3 2 5 5 3 3 ...
##  $ Diam : num  10.7 14 9 8 10 10.5 16 15 6.5 5 ...
##  $ Time : num  47.6 63.1 58.8 34.9 55.5 ...
##  $ Price: num  144 215 105 69 134 129 155 99 38.5 36.5 ...
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(}\AttributeTok{x=}\NormalTok{nambeware}\SpecialCharTok{$}\NormalTok{Price, }\AttributeTok{y=}\NormalTok{nambeware}\SpecialCharTok{$}\NormalTok{Type)}
\end{Highlighting}
\end{Shaded}

\includegraphics{chap_11_nghia_files/figure-latex/unnamed-chunk-2-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(nambeware}\SpecialCharTok{$}\NormalTok{Diam, nambeware}\SpecialCharTok{$}\NormalTok{Time)}
\end{Highlighting}
\end{Shaded}

\includegraphics{chap_11_nghia_files/figure-latex/unnamed-chunk-2-2.pdf}
Nhận xét: Đường kính càng lớn, tgian mài và đánh bóng càng lớn
=\textgreater{} giá càng cao =\textgreater{} mô hình liên tục dương
=\textgreater{} gamma glm or inverse gaussian

pearson.gof \textless- sum(yd.glm\(weights*yd.glm\)residuals\^{}2) tab
\textless-data.frame(GoF.Statistic=c(yd.glm\(deviance, pearson.gof)) tab\)DF
\textless- rep(yd.glm\(df.residual,2) tab\)P.Value \textless-
pchisq(tab\(GoF,df=tab\)DF,lower.tail = FALSE)
row.names(tab)\textless-c(``Deviance'',``Pearson''); print(tab,digits=3)

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{nam\_gamma }\OtherTok{=} \FunctionTok{glm}\NormalTok{( Price }\SpecialCharTok{\textasciitilde{}}\NormalTok{ (Diam}\SpecialCharTok{+}\NormalTok{Time) }\SpecialCharTok{*}\NormalTok{ Type, }\AttributeTok{family=}\FunctionTok{Gamma}\NormalTok{(}\AttributeTok{link=}\NormalTok{log), }\AttributeTok{data=}\NormalTok{nambeware )}
\end{Highlighting}
\end{Shaded}

Tính gof cho mô hình pchisq(deviance(ks.noMO), df.residual(ks.noMO),
lower.tail=FALSE)

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pearson.gof }\OtherTok{\textless{}{-}} \FunctionTok{sum}\NormalTok{(nam\_gamma}\SpecialCharTok{$}\NormalTok{weights}\SpecialCharTok{*}\NormalTok{nam\_gamma}\SpecialCharTok{$}\NormalTok{residuals}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\NormalTok{tab }\OtherTok{\textless{}{-}}\FunctionTok{data.frame}\NormalTok{(}\AttributeTok{GoF.Statistic=}\FunctionTok{c}\NormalTok{(nam\_gamma}\SpecialCharTok{$}\NormalTok{deviance, pearson.gof))}
\NormalTok{tab}\SpecialCharTok{$}\NormalTok{DF }\OtherTok{\textless{}{-}} \FunctionTok{rep}\NormalTok{(nam\_gamma}\SpecialCharTok{$}\NormalTok{df.residual,}\DecValTok{2}\NormalTok{)}
\NormalTok{tab}\SpecialCharTok{$}\NormalTok{P.Value }\OtherTok{\textless{}{-}} \FunctionTok{pchisq}\NormalTok{(tab}\SpecialCharTok{$}\NormalTok{GoF,}\AttributeTok{df=}\NormalTok{tab}\SpecialCharTok{$}\NormalTok{DF,}\AttributeTok{lower.tail =} \ConstantTok{FALSE}\NormalTok{)}
\FunctionTok{row.names}\NormalTok{(tab)}\OtherTok{\textless{}{-}}\FunctionTok{c}\NormalTok{(}\StringTok{"Deviance"}\NormalTok{,}\StringTok{"Pearson"}\NormalTok{); }\FunctionTok{print}\NormalTok{(tab,}\AttributeTok{digits=}\DecValTok{3}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##          GoF.Statistic DF P.Value
## Deviance          1.50 44       1
## Pearson           1.51 44       1
\end{verbatim}

pvalue = 1: mô hình chọn là chính xác

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(nam\_gamma)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## glm(formula = Price ~ (Diam + Time) * Type, family = Gamma(link = log), 
##     data = nambeware)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -0.35311  -0.09948  -0.01818   0.07750   0.33455  
## 
## Coefficients:
##                    Estimate Std. Error t value Pr(>|t|)    
## (Intercept)        2.655296   0.138511  19.170  < 2e-16 ***
## Diam               0.093638   0.016522   5.668 1.04e-06 ***
## Time               0.021397   0.004246   5.039 8.48e-06 ***
## TypeCassDish       1.152082   0.459773   2.506   0.0160 *  
## TypeDish          -0.035872   0.331821  -0.108   0.9144    
## TypePlate         -0.258805   0.401200  -0.645   0.5222    
## TypeTray          -0.272414   0.233403  -1.167   0.2494    
## Diam:TypeCassDish -0.073769   0.036014  -2.048   0.0465 *  
## Diam:TypeDish      0.018408   0.052468   0.351   0.7274    
## Diam:TypePlate     0.049484   0.027154   1.822   0.0752 .  
## Diam:TypeTray      0.071663   0.034805   2.059   0.0454 *  
## Time:TypeCassDish -0.005924   0.005677  -1.044   0.3024    
## Time:TypeDish     -0.002163   0.009295  -0.233   0.8171    
## Time:TypePlate    -0.022357   0.018487  -1.209   0.2330    
## Time:TypeTray     -0.026773   0.007730  -3.463   0.0012 ** 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for Gamma family taken to be 0.03430979)
## 
##     Null deviance: 20.2679  on 58  degrees of freedom
## Residual deviance:  1.4995  on 44  degrees of freedom
## AIC: 488.88
## 
## Number of Fisher Scoring iterations: 6
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{round}\NormalTok{(}\FunctionTok{anova}\NormalTok{(nam\_gamma, }\AttributeTok{test=}\StringTok{"F"}\NormalTok{), }\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Analysis of Deviance Table
## 
## Model: Gamma, link: log
## 
## Response: Price
## 
## Terms added sequentially (first to last)
## 
## 
##           Df Deviance Resid. Df Resid. Dev      F Pr(>F)    
## NULL                         58      20.27                  
## Diam       1    12.47        57       7.79 363.57 <2e-16 ***
## Time       1     3.65        56       4.14 106.51 <2e-16 ***
## Type       4     1.77        52       2.37  12.89 <2e-16 ***
## Diam:Type  4     0.45        48       1.92   3.28   0.02 *  
## Time:Type  4     0.42        44       1.50   3.07   0.03 *  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
\end{verbatim}

Các pvalue đều \textless{} 0.05 =\textgreater{} các biến giải thích có
đóng góp vào mô hình

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(statmod)}
\end{Highlighting}
\end{Shaded}

Kiếm tra gof

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{scatter.smooth}\NormalTok{( }\FunctionTok{rstandard}\NormalTok{(nam\_gamma) }\SpecialCharTok{\textasciitilde{}} \FunctionTok{log}\NormalTok{(}\FunctionTok{fitted}\NormalTok{(nam\_gamma)), }\AttributeTok{las=}\DecValTok{1}\NormalTok{,}
\AttributeTok{xlab=}\StringTok{"Log of fitted values"}\NormalTok{, }\AttributeTok{ylab=}\StringTok{"Standardized residuals"}\NormalTok{ )}
\end{Highlighting}
\end{Shaded}

\includegraphics{chap_11_nghia_files/figure-latex/unnamed-chunk-8-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{( }\FunctionTok{cooks.distance}\NormalTok{(nam\_gamma), }\AttributeTok{type=}\StringTok{"h"}\NormalTok{, }\AttributeTok{las=}\DecValTok{1}\NormalTok{,}
\AttributeTok{ylab=}\StringTok{"Cook\textquotesingle{}s distance, D"}\NormalTok{ )}
\end{Highlighting}
\end{Shaded}

\includegraphics{chap_11_nghia_files/figure-latex/unnamed-chunk-8-2.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(}\FunctionTok{hatvalues}\NormalTok{(nam\_gamma), }\AttributeTok{type =} \StringTok{"h"}\NormalTok{, }\AttributeTok{las =} \DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{chap_11_nghia_files/figure-latex/unnamed-chunk-8-3.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{qqnorm}\NormalTok{( qr }\OtherTok{\textless{}{-}} \FunctionTok{qresid}\NormalTok{(nam\_gamma), }\AttributeTok{las=}\DecValTok{1}\NormalTok{ ); }\FunctionTok{qqline}\NormalTok{(qr)}
\end{Highlighting}
\end{Shaded}

\includegraphics{chap_11_nghia_files/figure-latex/unnamed-chunk-8-4.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{( }\FunctionTok{rstandard}\NormalTok{(nam\_gamma) }\SpecialCharTok{\textasciitilde{}}\NormalTok{ nambeware}\SpecialCharTok{$}\NormalTok{Type, }\AttributeTok{las=}\DecValTok{1}\NormalTok{,}
\AttributeTok{xlab=}\StringTok{"Variety"}\NormalTok{, }\AttributeTok{ylab=}\StringTok{"Standardized residuals"}\NormalTok{ )}
\end{Highlighting}
\end{Shaded}

\includegraphics{chap_11_nghia_files/figure-latex/unnamed-chunk-8-5.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{colSums}\NormalTok{(}\FunctionTok{influence.measures}\NormalTok{(nam\_gamma)}\SpecialCharTok{$}\NormalTok{is.inf)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   dfb.1_ dfb.Diam dfb.Time dfb.TyCD dfb.TypD dfb.TypP dfb.TypT dfb.D:TC 
##        0        0        1        1        0        0        1        1 
## dfb.D:TD dfb.D:TP dfb.D:TT dfb.T:TC dfb.T:TD dfb.T:TP dfb.T:TT    dffit 
##        0        0        1        0        0        0        1        1 
##    cov.r   cook.d      hat 
##       12        1        0
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(nam\_gamma)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## glm(formula = Price ~ (Diam + Time) * Type, family = Gamma(link = log), 
##     data = nambeware)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -0.35311  -0.09948  -0.01818   0.07750   0.33455  
## 
## Coefficients:
##                    Estimate Std. Error t value Pr(>|t|)    
## (Intercept)        2.655296   0.138511  19.170  < 2e-16 ***
## Diam               0.093638   0.016522   5.668 1.04e-06 ***
## Time               0.021397   0.004246   5.039 8.48e-06 ***
## TypeCassDish       1.152082   0.459773   2.506   0.0160 *  
## TypeDish          -0.035872   0.331821  -0.108   0.9144    
## TypePlate         -0.258805   0.401200  -0.645   0.5222    
## TypeTray          -0.272414   0.233403  -1.167   0.2494    
## Diam:TypeCassDish -0.073769   0.036014  -2.048   0.0465 *  
## Diam:TypeDish      0.018408   0.052468   0.351   0.7274    
## Diam:TypePlate     0.049484   0.027154   1.822   0.0752 .  
## Diam:TypeTray      0.071663   0.034805   2.059   0.0454 *  
## Time:TypeCassDish -0.005924   0.005677  -1.044   0.3024    
## Time:TypeDish     -0.002163   0.009295  -0.233   0.8171    
## Time:TypePlate    -0.022357   0.018487  -1.209   0.2330    
## Time:TypeTray     -0.026773   0.007730  -3.463   0.0012 ** 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for Gamma family taken to be 0.03430979)
## 
##     Null deviance: 20.2679  on 58  degrees of freedom
## Residual deviance:  1.4995  on 44  degrees of freedom
## AIC: 488.88
## 
## Number of Fisher Scoring iterations: 6
\end{verbatim}

tham số phân tán phi: 0.03430979 đủ nhỏ Các đường thống kê mô tả theo ta
thấy rất tốt: mô hình được chọn là chính xác với phân phối gamma

phân phối invese gausian

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{nam\_inverse }\OtherTok{=} \FunctionTok{glm}\NormalTok{( Price }\SpecialCharTok{\textasciitilde{}}\NormalTok{ (Diam}\SpecialCharTok{+}\NormalTok{Time) }\SpecialCharTok{*}\NormalTok{ Type, }\AttributeTok{family=}\FunctionTok{inverse.gaussian}\NormalTok{(}\AttributeTok{link=}\NormalTok{log), }\AttributeTok{data=}\NormalTok{nambeware )}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pearson.gof }\OtherTok{\textless{}{-}} \FunctionTok{sum}\NormalTok{(nam\_inverse}\SpecialCharTok{$}\NormalTok{weights}\SpecialCharTok{*}\NormalTok{nam\_inverse}\SpecialCharTok{$}\NormalTok{residuals}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\NormalTok{tab }\OtherTok{\textless{}{-}}\FunctionTok{data.frame}\NormalTok{(}\AttributeTok{GoF.Statistic=}\FunctionTok{c}\NormalTok{(nam\_inverse}\SpecialCharTok{$}\NormalTok{deviance, pearson.gof))}
\NormalTok{tab}\SpecialCharTok{$}\NormalTok{DF }\OtherTok{\textless{}{-}} \FunctionTok{rep}\NormalTok{(nam\_inverse}\SpecialCharTok{$}\NormalTok{df.residual,}\DecValTok{2}\NormalTok{)}
\NormalTok{tab}\SpecialCharTok{$}\NormalTok{P.Value }\OtherTok{\textless{}{-}} \FunctionTok{pchisq}\NormalTok{(tab}\SpecialCharTok{$}\NormalTok{GoF,}\AttributeTok{df=}\NormalTok{tab}\SpecialCharTok{$}\NormalTok{DF,}\AttributeTok{lower.tail =} \ConstantTok{FALSE}\NormalTok{)}
\FunctionTok{row.names}\NormalTok{(tab)}\OtherTok{\textless{}{-}}\FunctionTok{c}\NormalTok{(}\StringTok{"Deviance"}\NormalTok{,}\StringTok{"Pearson"}\NormalTok{); }\FunctionTok{print}\NormalTok{(tab,}\AttributeTok{digits=}\DecValTok{3}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##          GoF.Statistic DF P.Value
## Deviance        0.0162 44       1
## Pearson         0.0151 44       1
\end{verbatim}

pvalue đều bằng 1: mô hình đc chọn là phù hợp

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{round}\NormalTok{(}\FunctionTok{anova}\NormalTok{(nam\_inverse, }\AttributeTok{test=}\StringTok{"F"}\NormalTok{), }\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Analysis of Deviance Table
## 
## Model: inverse.gaussian, link: log
## 
## Response: Price
## 
## Terms added sequentially (first to last)
## 
## 
##           Df Deviance Resid. Df Resid. Dev      F Pr(>F)    
## NULL                         58       0.29                  
## Diam       1     0.19        57       0.10 543.05 <2e-16 ***
## Time       1     0.05        56       0.05 145.45 <2e-16 ***
## Type       4     0.03        52       0.02  23.10 <2e-16 ***
## Diam:Type  4     0.00        48       0.02   2.59   0.05 *  
## Time:Type  4     0.00        44       0.02   1.66   0.18    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
\end{verbatim}

Ta thấy có p-value của biến time:type \textgreater{} 0.05
=\textgreater{} cần update mô hình

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{nam\_inverse\_up }\OtherTok{\textless{}{-}} \FunctionTok{update}\NormalTok{(nam\_inverse, .}\SpecialCharTok{\textasciitilde{}}\NormalTok{ Diam}\SpecialCharTok{+}\NormalTok{Time)}
\FunctionTok{summary}\NormalTok{(nam\_inverse\_up)}\SpecialCharTok{$}\NormalTok{dispersion}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 0.000760345
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{round}\NormalTok{(}\FunctionTok{anova}\NormalTok{(nam\_inverse\_up, }\AttributeTok{test =} \StringTok{"F"}\NormalTok{),}\DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Analysis of Deviance Table
## 
## Model: inverse.gaussian, link: log
## 
## Response: Price
## 
## Terms added sequentially (first to last)
## 
## 
##      Df Deviance Resid. Df Resid. Dev      F    Pr(>F)    
## NULL                    58       0.29                     
## Diam  1     0.19        57       0.10 244.65 < 2.2e-16 ***
## Time  1     0.05        56       0.05  65.53 < 2.2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(nam\_inverse\_up)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## glm(formula = Price ~ Diam + Time, family = inverse.gaussian(link = log), 
##     data = nambeware)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -0.09160  -0.01884  -0.00009   0.01674   0.04276  
## 
## Coefficients:
##             Estimate Std. Error t value Pr(>|t|)    
## (Intercept) 2.563734   0.089054  28.789  < 2e-16 ***
## Diam        0.094446   0.011827   7.986 8.17e-11 ***
## Time        0.021218   0.002907   7.299 1.11e-09 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for inverse.gaussian family taken to be 0.000760345)
## 
##     Null deviance: 0.289526  on 58  degrees of freedom
## Residual deviance: 0.053682  on 56  degrees of freedom
## AIC: 521.11
## 
## Number of Fisher Scoring iterations: 6
\end{verbatim}

có tham số phân tán phi = 0.0003425448 rất nhỏ: mô hình được chọn là
chính xác

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{scatter.smooth}\NormalTok{( }\FunctionTok{rstandard}\NormalTok{(nam\_inverse\_up) }\SpecialCharTok{\textasciitilde{}} \FunctionTok{log}\NormalTok{(}\FunctionTok{fitted}\NormalTok{(nam\_inverse\_up)), }\AttributeTok{las=}\DecValTok{1}\NormalTok{,}
\AttributeTok{xlab=}\StringTok{"Log of fitted values"}\NormalTok{, }\AttributeTok{ylab=}\StringTok{"Standardized residuals"}\NormalTok{ )}
\end{Highlighting}
\end{Shaded}

\includegraphics{chap_11_nghia_files/figure-latex/unnamed-chunk-17-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{( }\FunctionTok{cooks.distance}\NormalTok{(nam\_inverse\_up), }\AttributeTok{type=}\StringTok{"h"}\NormalTok{, }\AttributeTok{las=}\DecValTok{1}\NormalTok{,}
\AttributeTok{ylab=}\StringTok{"Cook\textquotesingle{}s distance, D"}\NormalTok{ )}
\end{Highlighting}
\end{Shaded}

\includegraphics{chap_11_nghia_files/figure-latex/unnamed-chunk-17-2.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{qqnorm}\NormalTok{( qr }\OtherTok{\textless{}{-}} \FunctionTok{qresid}\NormalTok{(nam\_inverse\_up), }\AttributeTok{las=}\DecValTok{1}\NormalTok{ ); }\FunctionTok{qqline}\NormalTok{(qr)}
\end{Highlighting}
\end{Shaded}

\includegraphics{chap_11_nghia_files/figure-latex/unnamed-chunk-17-3.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{( }\FunctionTok{rstandard}\NormalTok{(nam\_inverse\_up) }\SpecialCharTok{\textasciitilde{}}\NormalTok{ nambeware}\SpecialCharTok{$}\NormalTok{Type, }\AttributeTok{las=}\DecValTok{1}\NormalTok{,}
\AttributeTok{xlab=}\StringTok{"Variety"}\NormalTok{, }\AttributeTok{ylab=}\StringTok{"Standardized residuals"}\NormalTok{ )}
\end{Highlighting}
\end{Shaded}

\includegraphics{chap_11_nghia_files/figure-latex/unnamed-chunk-17-4.pdf}
Đồ thị theo quan sát đã fit hơn: mô hình chính xác Đánh giá theo AIC:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{c}\NormalTok{(}\StringTok{"Gamma:"}\OtherTok{=}\FunctionTok{AIC}\NormalTok{(nam\_gamma),}

  \StringTok{"Inverse:"}\OtherTok{=}\FunctionTok{AIC}\NormalTok{(nam\_inverse\_up))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   Gamma: Inverse: 
## 488.8783 521.1054
\end{verbatim}

AIC của Inverse Gaussian \textgreater{} AIC Gamma GLM =\textgreater{}
chọn Gamma

\end{document}
