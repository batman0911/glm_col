% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\title{common}
\author{linhnm}
\date{2022-05-17}

\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  pdftitle={common},
  pdfauthor={linhnm},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi

\begin{document}
\maketitle

\hypertarget{chapter-10}{%
\subsection{Chapter 10}\label{chapter-10}}

\hypertarget{problem-17}{%
\subsubsection{Problem 17}\label{problem-17}}

An experiment {[}23, 36{]} recorded the time to failure of a piece of
electronic equipment while operating in two diﬀerent modes. In any
session, the machine is run in both modes for varying amounts of time
(Table 10.20; dataset: failures). For each operating period, Mode 1 is
the time spent operating in one mode and Mode 2 is the time spent
operating in the other mode. The number of failures in each period is
recorded, where each operating period is measured in weeks. The interest
is in ﬁnding a model for the number of failures given the amount of time
the equipment spends in the two modes.

Table 10.20 Observations on electronic equipment failures. The time
spent in each mode is measured in weeks (Problem 10.17)

\begin{verbatim}
##   Period Time1 Time2 Failures
## 1      1  33.3  25.3       15
## 2      2  52.2  14.4        9
## 3      3  64.7  32.5       14
## 4      4 137.0  20.5       24
## 5      5 125.9  97.6       27
## 6      6 116.3  53.6       27
## 7      7 131.7  56.6       23
## 8      8  85.0  87.3       18
## 9      9  91.9  47.8       22
\end{verbatim}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Plot the number of failures against the time spent in Mode 1, and then
  against the time spent in Mode 2.
\item
  Show that an identity link function may be appropriate.
\item
  Fit the Poisson model, to model the number of failures as a function
  of the time spent in the two modes. Which mode appears to be the major
  source of failures?
\item
  Is there evidence of under- or overdispersion?
\item
  Interpret the ﬁnal model.
\end{enumerate}

\textbf{Solution:}

\textbf{1.}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(Failures }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Time1, }\AttributeTok{data=}\NormalTok{failures, }\AttributeTok{xlab=}\StringTok{"Time spent in Mode 1"}\NormalTok{, }\AttributeTok{ylab=}\StringTok{"Number of failures"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{common_files/figure-latex/unnamed-chunk-2-1.pdf}

Tu biểu đồ ta có thể thấy mối quan hệ giữa Số lần trục trặc và thời gian
hoạt động ở chế độ 1 là xấp xỉ tuyến tính.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{par}\NormalTok{(}\AttributeTok{mfrow=}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{))}
\FunctionTok{plot}\NormalTok{(Failures }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Time2, }\AttributeTok{data=}\NormalTok{failures,}\AttributeTok{xlab=}\StringTok{"Time spent in Mode 2"}\NormalTok{,}\AttributeTok{ylab=}\StringTok{"Number of failures"}\NormalTok{)}
\FunctionTok{plot}\NormalTok{(}\FunctionTok{log}\NormalTok{(Failures) }\SpecialCharTok{\textasciitilde{}} \FunctionTok{log}\NormalTok{(Time2), }\AttributeTok{data=}\NormalTok{failures,}\AttributeTok{xlab=}\StringTok{"log(Time spent in Mode 2)"}\NormalTok{,}\AttributeTok{ylab=}\StringTok{"Number of failures"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{common_files/figure-latex/unnamed-chunk-3-1.pdf}

Biểu đồ chỉ ra xu hướng tương đối tuyến tính giữa số lần trục trặc và
log của thời gian hoạt động ở chế độ 2.

\textbf{2.}

Ta thử thử fit một mô hình hồi quy tuyến tính (link function là
identity)

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{fitted.identity }\OtherTok{\textless{}{-}} \FunctionTok{lm}\NormalTok{(Failures }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Time1 }\SpecialCharTok{+} \FunctionTok{log}\NormalTok{(Time2), }\AttributeTok{data=}\NormalTok{failures)}
\FunctionTok{printCoefmat}\NormalTok{( }\FunctionTok{coef}\NormalTok{( }\FunctionTok{summary}\NormalTok{(fitted.identity)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##              Estimate Std. Error t value Pr(>|t|)   
## (Intercept) -1.788339   6.356282 -0.2813 0.787893   
## Time1        0.122990   0.033135  3.7118 0.009949 **
## log(Time2)   2.760783   1.902255  1.4513 0.196889   
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
\end{verbatim}

Giá trị kiểm định các hệ số cho thấy một mô hình hồi quy tuyến tính là
tương đối phù hợp

\textbf{3.}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{fitted.poisson }\OtherTok{\textless{}{-}} \FunctionTok{glm}\NormalTok{(Failures }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Time1 }\SpecialCharTok{+} \FunctionTok{log}\NormalTok{(Time2), }\AttributeTok{data=}\NormalTok{failures, }\AttributeTok{family=}\FunctionTok{poisson}\NormalTok{(}\AttributeTok{link=}\StringTok{"log"}\NormalTok{))}
\FunctionTok{printCoefmat}\NormalTok{( }\FunctionTok{coef}\NormalTok{( }\FunctionTok{summary}\NormalTok{(fitted.poisson)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##              Estimate Std. Error z value  Pr(>|z|)    
## (Intercept) 1.7487107  0.4906944  3.5637 0.0003656 ***
## Time1       0.0067231  0.0024705  2.7213 0.0065024 ** 
## log(Time2)  0.1552467  0.1344196  1.1549 0.2481143    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
\end{verbatim}

Tư bảng ANOVA, ta thấy rằng hiệu ứng của Thời gian hoạt động ở chế độ 1
là đáng kể tới tần suất hỏng của thiết bị, trong khi hiệu ứng của Thời
gian hoạt động ở chế độ 2 là không đáng kể.

\textbf{4.}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{deviance}\NormalTok{(fitted.poisson)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 3.454126
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{df.residual}\NormalTok{(fitted.poisson)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 6
\end{verbatim}

Tu dữ liệu ta thấy độ chệch phần dự nhỏ hơn bậc tự do phần dư , nên mô
hình có hiện tượng underdispersion

\textbf{5.}

Mô hình Poisson GLM có hiện tương underdispersion, vậy nên ta tìm kiếm
một mô hình thay thế là quasi-Poisson. Vì Mode 2 không có ý nghĩa thống
kê nên ta cũng loại khỏi mô hình

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{m.qp }\OtherTok{\textless{}{-}} \FunctionTok{glm}\NormalTok{(Failures }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Time1, }\AttributeTok{data=}\NormalTok{failures, }\AttributeTok{family=}\NormalTok{quasipoisson)}
\FunctionTok{printCoefmat}\NormalTok{( }\FunctionTok{coef}\NormalTok{( }\FunctionTok{summary}\NormalTok{(m.qp)))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##              Estimate Std. Error t value  Pr(>|t|)    
## (Intercept) 2.2371963  0.1977659 11.3123 9.439e-06 ***
## Time1       0.0077051  0.0018424  4.1822  0.004126 ** 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
\end{verbatim}

\emph{Goodness of fit test }

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{fit }\OtherTok{\textless{}{-}}\NormalTok{ m.qp}
\NormalTok{pearson.gof }\OtherTok{\textless{}{-}} \FunctionTok{sum}\NormalTok{(fit}\SpecialCharTok{$}\NormalTok{weights }\SpecialCharTok{*}\NormalTok{ fit}\SpecialCharTok{$}\NormalTok{residuals}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{)}
\NormalTok{tab }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{GoF.Statistic=}\FunctionTok{c}\NormalTok{(fit}\SpecialCharTok{$}\NormalTok{deviance, pearson.gof))}
\NormalTok{tab}\SpecialCharTok{$}\NormalTok{DF }\OtherTok{\textless{}{-}} \FunctionTok{rep}\NormalTok{(fit}\SpecialCharTok{$}\NormalTok{df.residual, }\DecValTok{2}\NormalTok{)}
\NormalTok{tab}\SpecialCharTok{$}\NormalTok{P.Value }\OtherTok{\textless{}{-}} \FunctionTok{pchisq}\NormalTok{(tab}\SpecialCharTok{$}\NormalTok{GoF, }\AttributeTok{df=}\NormalTok{tab}\SpecialCharTok{$}\NormalTok{DF, }\AttributeTok{lower.tail=}\ConstantTok{FALSE}\NormalTok{)}
\FunctionTok{row.names}\NormalTok{(tab) }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"Deviance"}\NormalTok{, }\StringTok{"Pearson"}\NormalTok{); }\FunctionTok{print}\NormalTok{(tab, }\AttributeTok{digits=}\DecValTok{3}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##          GoF.Statistic DF P.Value
## Deviance          4.81  7   0.683
## Pearson           4.63  7   0.704
\end{verbatim}

=\textgreater{} Giá trị của kiểm định goodness of fit cho thấy mô hình
chưa có đủ các biến cần thiết để biểu diễn tính hệ thống của biến đầu ra
.

\emph{Tiến hành chuẩn đoán mô hình:} Kiểm tra phần dư GLM

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{( }\FunctionTok{resid}\NormalTok{(m.qp) }\SpecialCharTok{\textasciitilde{}} \FunctionTok{sqrt}\NormalTok{(}\FunctionTok{fitted}\NormalTok{(m.qp)), }\AttributeTok{las=}\DecValTok{1}\NormalTok{, }\AttributeTok{main=}\StringTok{"Deviance residuals"}\NormalTok{, }\AttributeTok{ylab=}\StringTok{"Deviance residuals"}\NormalTok{,}\AttributeTok{xlab=}\StringTok{"Square root of fitted values"}\NormalTok{ )}
\end{Highlighting}
\end{Shaded}

\includegraphics{common_files/figure-latex/unnamed-chunk-9-1.pdf}

Kiểm tra sự phù hợp của việc lựa chọn Poisson GLM

=\textgreater{} Biểu đồ thể hiện một random pattern của phần dư chứng tỏ
rằng mô hình là tương đối phù hợp

Kiểm tra ảnh hưởng của các quan sát

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{( }\FunctionTok{cooks.distance}\NormalTok{(m.qp), }\AttributeTok{type=}\StringTok{"h"}\NormalTok{, }\AttributeTok{las=}\DecValTok{1}\NormalTok{,}\AttributeTok{ylab=}\StringTok{"Cook\textquotesingle{}s distance, D"}\NormalTok{, }\AttributeTok{main=}\StringTok{"Cook\textquotesingle{}s distance"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{common_files/figure-latex/unnamed-chunk-10-1.pdf}

Kiểm tra Possion EDM có phù hợp với biến đầu ra không

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{qqnorm}\NormalTok{( }\FunctionTok{resid}\NormalTok{(m.qp), }\AttributeTok{las=}\DecValTok{1}\NormalTok{,}\AttributeTok{main=}\StringTok{"Normal Q{-}Q plot}\SpecialCharTok{\textbackslash{}n}\StringTok{deviance residuals"}\NormalTok{)}
\FunctionTok{qqline}\NormalTok{( }\FunctionTok{resid}\NormalTok{(m.qp))}
\end{Highlighting}
\end{Shaded}

\includegraphics{common_files/figure-latex/unnamed-chunk-11-1.pdf}

=\textgreater{} Tu biểu đồ có thể thấy rằng các phân vị của mẫu bám sát
đường phân vị lý thuyết nên mô hình Poisson là phù hợp

\emph{Công thức của Mô hình:}

\[
log(\mu) = 2.237 + 0.0077T_{1}
\]

Trong đó: \(T_{1}\) là nhân tố Thời gian hoạt động ở chế độ Mode 1

\hypertarget{problem-18}{%
\subsubsection{Problem 18}\label{problem-18}}

A report on Canadian cancer statistics estimated the number of deaths
from various types of cancer in Canada in 2000 {[}7{]}. The ﬁve leading
cancer sites are studied here (Table 10.21; data set: ccancer).

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Plot the cancer rates per thousand of population against each
  geographical location, and then against gender. Comment on the
  relationships.
\item
  Identify the zeros as systematic or sampling.
\item
  Find an appropriate model for the data using an appropriate oﬀset. Do
  the cancer rates appear to diﬀer across the geographic regions?
\item
  Interpret the ﬁtted model.
\end{enumerate}

Table 10.21 The estimated number of deaths for the ﬁve leading cancer
sites in Canada in 2000, by geographic region and gender (Problem 10.18)

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{data}\NormalTok{(}\StringTok{"ccancer"}\NormalTok{)}
\NormalTok{ccancer}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##    Count Gender       Region       Site Population
## 1   3500      M      Ontario       Lung   11874400
## 2   1250      M      Ontario Colorectal   11874400
## 3      0      M      Ontario     Breast   11874400
## 4   1600      M      Ontario   Prostate   11874400
## 5    540      M      Ontario   Pancreas   11874400
## 6   2400      F      Ontario       Lung   11874400
## 7   1050      F      Ontario Colorectal   11874400
## 8   2100      F      Ontario     Breast   11874400
## 9      0      F      Ontario   Prostate   11874400
## 10   590      F      Ontario   Pancreas   11874400
## 11   240      M Newfoundland       Lung     533800
## 12    60      M Newfoundland Colorectal     533800
## 13     0      M Newfoundland     Breast     533800
## 14    80      M Newfoundland   Prostate     533800
## 15    20      M Newfoundland   Pancreas     533800
## 16    95      F Newfoundland       Lung     533800
## 17    50      F Newfoundland Colorectal     533800
## 18    95      F Newfoundland     Breast     533800
## 19     0      F Newfoundland   Prostate     533800
## 20    25      F Newfoundland   Pancreas     533800
## 21  3500      M       Quebec       Lung    7410500
## 22  1100      M       Quebec Colorectal    7410500
## 23     0      M       Quebec     Breast    7410500
## 24   900      M       Quebec   Prostate    7410500
## 25   390      M       Quebec   Pancreas    7410500
## 26  2000      F       Quebec       Lung    7410500
## 27  1000      F       Quebec Colorectal    7410500
## 28  1450      F       Quebec     Breast    7410500
## 29     0      F       Quebec   Prostate    7410500
## 30   410      F       Quebec   Pancreas    7410500
\end{verbatim}

\textbf{1.}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{with}\NormalTok{(ccancer, \{}
\NormalTok{  Cancer.Rate }\OtherTok{\textless{}{-}}\NormalTok{ Count}\SpecialCharTok{/}\NormalTok{Population}\SpecialCharTok{*}\DecValTok{1000}
  \FunctionTok{plot}\NormalTok{(Cancer.Rate }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Region, }\AttributeTok{data=}\NormalTok{ccancer, }\AttributeTok{xlab=}\StringTok{"Region"}\NormalTok{,}\AttributeTok{ylab=}\StringTok{"Cancer rate per thousand people"}\NormalTok{, }\AttributeTok{las=}\DecValTok{1}\NormalTok{, }\AttributeTok{main=}\StringTok{"Cancer rate against Geographic location"}\NormalTok{)}
  \FunctionTok{plot}\NormalTok{(Cancer.Rate }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Gender, }\AttributeTok{data=}\NormalTok{ccancer, }\AttributeTok{xlab=}\StringTok{"Gender"}\NormalTok{, }\AttributeTok{ylab=}\StringTok{"Cancer rate per thousand people"}\NormalTok{, }\AttributeTok{las=}\DecValTok{1}\NormalTok{, }\AttributeTok{main=}\StringTok{"Cancer rate against Gender"}\NormalTok{)}
\NormalTok{\})}
\end{Highlighting}
\end{Shaded}

\includegraphics{common_files/figure-latex/unnamed-chunk-13-1.pdf}
\includegraphics{common_files/figure-latex/unnamed-chunk-13-2.pdf}

Tỉ lệ mắc các bệnh ung thư cớ sự chênh lệch không đáng kể giữa 2 thành
phố Newfoundland và Ontario nhưng nhỉnh hơn một chút ở Quebec, và mức độ
phân tán ở Quebec cũng cao hơn. Xét về giới tính, sự khác biệt cũng
không lớn, tỉ lệ mắc ung thư nhìn chung là co hơn ở nữ và độ phân tán
cũng lớn hơn.

\textbf{2.}

Để xem xét giá trị 0 ở một số loại ung thư là mang tính chất hệ thống
hay ngẫu nhiên . Ta thử xem sự phân bố của chúng theo giới tính :

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{with}\NormalTok{(ccancer,\{}
\NormalTok{  Count.by.Site.Gender }\OtherTok{\textless{}{-}} \FunctionTok{xtabs}\NormalTok{(Count }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Gender }\SpecialCharTok{+}\NormalTok{ Site)}
\NormalTok{  Count.by.Site.Gender}
\NormalTok{\})}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##       Site
## Gender Breast Colorectal Lung Pancreas Prostate
##      F   3645       2100 4495     1025        0
##      M      0       2410 7240      950     2580
\end{verbatim}

Tu dữ liệu ta thấy rằng, ung thư loại Prostate là loại ung thư chỉ xảy
ra ở Male nên giá trị này ở Female tất nhiên phải bằng 0 nên giá trị
zero ở đây là structual zero. Còn đối với ung thư loại Breast thì có thể
xảy ra cả ở Male và Female tuy nhiên sẽ ít hơn rất nhiều ở Male nên giá
trị 0 này sẽ là sampling zero.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(Count}\SpecialCharTok{/}\NormalTok{Population}\SpecialCharTok{*}\DecValTok{1000}\SpecialCharTok{\textasciitilde{}}\NormalTok{Site, }\AttributeTok{data=}\NormalTok{ccancer, }\AttributeTok{xlab=}\StringTok{"Site"}\NormalTok{, }\AttributeTok{ylab=}\StringTok{"Cancer rate per thousand people"}\NormalTok{, }\AttributeTok{las=}\DecValTok{1}\NormalTok{, }\AttributeTok{main=}\StringTok{"Cancer rate against Cancer Site"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{common_files/figure-latex/unnamed-chunk-15-1.pdf}
\textbf{3.}

Ta xét với Biến đầu ra là số lượng ca ung thư trên 1000 người, một mô
hình Poisson GLM có thể phù hợp . Thêm giá trị offset = log(Population)
để loại bỏ ảnh hưởng của quy mô dân số lên số lượng ca ung thư.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{m.p }\OtherTok{\textless{}{-}} \FunctionTok{glm}\NormalTok{(Count }\SpecialCharTok{\textasciitilde{}}\NormalTok{ Region }\SpecialCharTok{+}\NormalTok{ Gender }\SpecialCharTok{+}\NormalTok{ Site }\SpecialCharTok{+} \FunctionTok{offset}\NormalTok{(}\FunctionTok{log}\NormalTok{(Population)), }\AttributeTok{data=}\NormalTok{ccancer, }\AttributeTok{family=}\FunctionTok{poisson}\NormalTok{(}\AttributeTok{link=}\StringTok{"log"}\NormalTok{))}
\FunctionTok{printCoefmat}\NormalTok{(}\FunctionTok{coef}\NormalTok{(}\FunctionTok{summary}\NormalTok{(m.p)), }\AttributeTok{digits=}\DecValTok{3}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##                Estimate Std. Error z value Pr(>|z|)    
## (Intercept)     -9.3658     0.0422 -221.68  < 2e-16 ***
## RegionOntario   -0.1269     0.0398   -3.19  0.00141 ** 
## RegionQuebec     0.1522     0.0400    3.81  0.00014 ***
## GenderM          0.1570     0.0128   12.24  < 2e-16 ***
## SiteColorectal   0.2129     0.0223    9.56  < 2e-16 ***
## SiteLung         1.1692     0.0190   61.66  < 2e-16 ***
## SitePancreas    -0.6128     0.0279  -21.93  < 2e-16 ***
## SiteProstate    -0.3456     0.0257  -13.43  < 2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
\end{verbatim}

Giá trị kiểm định cho thấy rằng các hệ số của vị trí địa lý có ý nghĩa
thống kê trong mô hình .

\textbf{4.}

\end{document}
